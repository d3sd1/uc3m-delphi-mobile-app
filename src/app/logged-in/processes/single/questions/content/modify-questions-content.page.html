<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button (click)="goBack()" defaultHref="/logged-in/home/menu/processes" text="Volver"></ion-back-button>
    </ion-buttons>
    <ion-title>Modificar preguntas</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content><!-- The reorder gesture is disabled by default, enable it to drag and drop items -->

  <ion-item>
    <ion-label>Nombre</ion-label>
    <ion-input [(ngModel)]="this.process?.currentRound.questions[questionIndex].name"></ion-input>
  </ion-item>

  <ion-item>
    <ion-label>Tipo de pregunta</ion-label>
    <ion-select [(ngModel)]="this.process?.currentRound.questions[questionIndex].type">
      <ion-select-option value="QUALITATIVE">Cualitativa</ion-select-option>
      <ion-select-option value="QUANTITATIVE">Cuantitativa</ion-select-option>
      <ion-select-option value="BOOLTYPE">Booleana</ion-select-option>
      <ion-select-option value="CATCUSTOM">Categorías</ion-select-option>
      <ion-select-option value="CATLIKERT">Escala de Likert</ion-select-option>
      <ion-select-option value="CATMULTI">Categorías con selección múltiple</ion-select-option>
      <ion-select-option value="CATPOND">Categorías ponderadas</ion-select-option>
      <!-- este permite reordenar respuesta de categorías-->
    </ion-select>
  </ion-item>
  <ion-item>
    <ion-textarea [(ngModel)]="this.process.currentRound.questions[questionIndex].question"
                  placeholder="Introduce tu pregunta aquí"></ion-textarea>
  </ion-item>

  <div *ngIf="this.process?.currentRound.questions[questionIndex]?.type === 'QUANTITATIVE'">
    <ion-item>
      <ion-input [value]="this.process?.currentRound.questions[questionIndex]?.minVal"
                 placeholder="Valor mínimo"></ion-input>
      <ion-input [value]="this.process?.currentRound.questions[questionIndex]?.maxVal"
                 placeholder="Valor máximo"></ion-input>
    </ion-item>
    <ion-range [max]="10"
               [min]="0"
               color="primary"
               disabled="true" snaps step="1" value="5">
      <ion-icon color="danger" name="sad-outline" slot="start"></ion-icon>
      <ion-icon color="success" name="happy-outline" slot="end"></ion-icon>
    </ion-range>
  </div>
  <div *ngIf="this.process?.currentRound.questions[questionIndex]?.type === 'BOOLTYPE'">
    <ion-item>
      <ion-label>Respuesta</ion-label>
      <ion-select value="1">
        <ion-select-option disabled value="1">Sí</ion-select-option>
        <ion-select-option disabled value="0">No</ion-select-option>
      </ion-select>
    </ion-item>
  </div>
  <div *ngIf="this.process?.currentRound.questions[questionIndex]?.type === 'CATCUSTOM'">

    <ion-item>
      <ion-input [(ngModel)]="currentCategory" placeholder="Nombre categoría..."></ion-input>
      <ion-button (click)="addCategory()" size="small">Añadir categoría</ion-button>
    </ion-item>

    <ion-list>
      <ion-item-group>
        <ion-item-divider>
          <ion-label>Categorías</ion-label>
          <ion-badge
            slot="end">{{this.process?.currentRound.questions[this.questionIndex]?.categories.length}}</ion-badge>
        </ion-item-divider>

        <ion-item
          *ngFor="let category of this.process?.currentRound.questions[this.questionIndex]?.categories; let i = index">
          <ion-label>{{category.catName}}</ion-label>
          <ion-icon (click)="delCategory(category)" name="trash" slot="end"></ion-icon>
        </ion-item>
      </ion-item-group>
    </ion-list>
  </div>
  <div *ngIf="this.process?.currentRound.questions[questionIndex]?.type === 'CATLIKERT'">
    <ion-item>
      <ion-label>Escala de Likert</ion-label>
      <ion-select value="3">
        <ion-select-option disabled value="1">Totalmente en desacuerdo</ion-select-option>
        <ion-select-option disabled value="2">En desacuerdo</ion-select-option>
        <ion-select-option disabled value="3">Ni de acuerdo ni en desacuerdo</ion-select-option>
        <ion-select-option disabled value="4">De acuerdo</ion-select-option>
        <ion-select-option disabled value="5">Totalmente de acuerdo</ion-select-option>
      </ion-select>
    </ion-item>
  </div>

  <div *ngIf="this.process?.currentRound.questions[questionIndex]?.type == 'CATMULTI'">
    <ion-item>
      <ion-range [(ngModel)]="responseRange"
                 [max]="this.process?.currentRound.questions[this.questionIndex]?.categories.length + 1"
                 color="primary" min="1" snaps step="1">
        <ion-icon color="primary" name="aperture-outline" size="small" slot="start"></ion-icon>
        <ion-icon color="success" name="aperture" slot="end"></ion-icon>
      </ion-range>
    </ion-item>
    <ion-item>
      <ion-input [(ngModel)]="currentCategory" placeholder="Nombre categoría..."></ion-input>
      <ion-button (click)="addCategory()" size="small">Añadir categoría</ion-button>
    </ion-item>

    <ion-list>
      <ion-item-group>
        <ion-item-divider>
          <ion-label>Categorías</ion-label>
          <ion-badge
            slot="end">{{this.process?.currentRound.questions[this.questionIndex]?.categories.length}}</ion-badge>
        </ion-item-divider>

        <ion-item
          *ngFor="let category of this.process?.currentRound.questions[this.questionIndex]?.categories; let i = index">
          <ion-label>{{category.catName}}</ion-label>
          <ion-icon (click)="delCategory(category)" name="trash" slot="end"></ion-icon>
        </ion-item>
      </ion-item-group>
    </ion-list>
  </div>
  <div *ngIf="this.process?.currentRound.questions[questionIndex]?.type == 'CATPOND'">

    <ion-item>
      <ion-input [(ngModel)]="currentCategory" placeholder="Nombre categoría..."></ion-input>
      <ion-button (click)="addCategory()" size="small">Añadir categoría</ion-button>
    </ion-item>

    <ion-list>
      <ion-item-group>
        <ion-item-divider>
          <ion-label>Categorías</ion-label>
          <ion-badge
            slot="end">{{this.process?.currentRound.questions[this.questionIndex]?.categories.length}}</ion-badge>
        </ion-item-divider>

        <ion-item
          *ngFor="let category of this.process?.currentRound.questions[this.questionIndex]?.categories; let i = index">
          <ion-label>{{category.catName}}</ion-label>
          <ion-icon (click)="delCategory(category)" name="trash" slot="end"></ion-icon>
        </ion-item>
      </ion-item-group>
    </ion-list>
  </div>
</ion-content>


<ion-footer>
  <ion-toolbar>
    <ion-button (click)="saveQuestionContent()" expand="block">Guardar contenido</ion-button>
  </ion-toolbar>
</ion-footer>
