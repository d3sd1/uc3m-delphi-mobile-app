<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="../" routerLink="../" text="Volver"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ 'create_page.create' | translate }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- COORDINADOR ->>>>>>>>>

-- COORDINADOR
- Crear proceso delphi


--- Definir cuestionario (Meter preguntas meter preguntas que tengan str, metr preguntas de estrellitas)


- Cerrar ronda automáticamente cuando:
1. llega al final del tiempo
2. No quedan expertos por votar ni valorar

- Se puede cerrar ronda a mano

- Notificar a coordinador cuando experto vota
-->
  <ion-item>
    <ion-label position="floating">Nombre del proceso</ion-label>
    <ion-input [(ngModel)]="process.name"></ion-input>
  </ion-item>
  <ion-item>
    <ion-label position="floating">Descripción</ion-label>
    <ion-textarea [(ngModel)]="process.description"></ion-textarea>
  </ion-item>
  <ion-item>
    <ion-label position="floating">Fecha de finalización de proceso</ion-label>
    <ion-datetime displayFormat="D MMM YYYY H:mm" min="1997" max="2010" [(ngModel)]="process.endTime"></ion-datetime>
  </ion-item>

  <!-- Searchbar with a custom debounce -->
  <ion-searchbar debounce="500" animated placeholder="Buscar expertos" (focusout)="this.filterCriterial = null"
                 (ionChange)="filterExperts()" [(ngModel)]="filterCriterial"></ion-searchbar>
  <ion-list *ngIf="expertsFiltered.length > 0 && this.filterCriterial !== ''" class="experts-filtered">
    <ion-item *ngFor="let expert of expertsFiltered"
              (click)="pushExpert(expert)">{{ expert.name }} {{ expert.surnames }}</ion-item>
  </ion-list>
  <ion-item *ngIf="expertsFiltered?.length == 0 && this.filterCriterial !== ''">
    <ion-title>Búsqueda sin resultados</ion-title>
  </ion-item>
  <ion-item *ngIf="process.experts?.length == 0">
    <ion-title>Proceso sin expertos</ion-title>
  </ion-item>

  <ion-chip *ngFor="let expertUser of process.experts">
    <ion-avatar>
      <img [src]="expertUser.photo">
    </ion-avatar>
    <ion-label>{{expertUser.name}} {{expertUser.surnames}}</ion-label>
    <ion-icon name="close-circle" (click)="removeExpert(expertUser)"></ion-icon>
  </ion-chip>

  <!-- OBJETIVOS -->
  <ion-button expand="block" fill="outline" (click)="addRound()">Añadir ronda</ion-button>

  <ion-reorder-group disabled="false" *ngFor="let round of process.rounds; let roundIndex = index">
    <ion-item-divider>
      <ion-label>{{round.name}}</ion-label>
    </ion-item-divider>
    <ion-button expand="block" fill="outline" (click)="addQuestion(round)">Añadir pregunta</ion-button>


    <ion-label *ngFor="let question of process.rounds[roundIndex].questions">
      <ion-item>
        <ion-reorder></ion-reorder>
        <ion-input [placeholder]="question.name"></ion-input>
        <ion-icon *ngIf="expandedQuestion?.id === question.id" (click)="compressQuestion(round)" slot="end"
                  name="chevron-down-outline"></ion-icon>
        <ion-icon *ngIf="expandedQuestion?.id !== question.id" (click)="expandQuestion(question)" slot="end"
                  name="chevron-back-outline"></ion-icon>
      </ion-item><!--
      <ion-label *ngIf="expandedQuestion?.id === question.id">
        <ion-segment [(ngModel)]="expandedQuestion.type">
          <ion-segment-button [value]="QuestionType.QUALITATIVE" >
            <ion-label>Cualitativa</ion-label>
          </ion-segment-button>
          <ion-segment-button [value]="QuestionType.QUANTITATIVE">
            <ion-label>Cuantitativa</ion-label>
          </ion-segment-button>
        </ion-segment>
        <ion-icon name="star-outline"></ion-icon>
        <ion-icon name="star-outline"></ion-icon>
        <ion-icon name="star-outline"></ion-icon>
        <ion-icon name="star-outline"></ion-icon>
        <ion-icon name="star-outline"></ion-icon>
      </ion-label>-->
    </ion-label>
  </ion-reorder-group>

</ion-content>
